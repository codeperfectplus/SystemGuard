{% if card_settings.is_speedtest_enabled %}
<div class="col-md-12 mb-4">
    <div class="card bg-speedtest shadow-sm border-0 rounded-3">
        <div class="card-body text-center">
            <h5 class="card-title mb-3">Perform Speed Test <i class="fas fa-tachometer-alt"></i></h5>

            <!-- Loading Spinner -->
            <div id="loading-spinner" class="spinner-border text-primary mb-4" role="status" style="display: none;">
                <span class="visually-hidden">Loading...</span>
            </div>

            <!-- Speed Test Results -->
            <div id="speedtest-results">
                {% if not speedtest_result["show_prompt"] %}
                <p class="card-text fs-4 mb-2">
                    <span class="fw-bold">Download Speed:</span> {{ speedtest_result["download_speed"] }}
                </p>
                <p class="card-text fs-4 mb-2">
                    <span class="fw-bold">Upload Speed:</span> {{ speedtest_result["upload_speed"] }}
                </p>
                <p class="card-text fs-5 mb-2">
                    <span class="fw-bold">Test Last Performed:</span> {{ last_timestamp }}
                </p>
                <p class="card-text fs-5 mb-3">
                    <span class="fw-bold">Try again in:</span> {{ speedtest_result["remaining_time_for_next_test"] }} mins
                </p>
                {% endif %}
            </div>

            <!-- Speed Test Button -->
            {% if speedtest_result["show_prompt"] %}
            <a href="{{ url_for('speedtest') }}" id="speedtest-btn" class="btn btn-primary btn-lg" onclick="showLoading()">Run Speed Test</a>
            {% endif %}
        </div>
    </div>
</div>
{% endif %}

<script>
    function showLoading() {
        // Show loading spinner and hide the results
        document.getElementById('loading-spinner').style.display = 'block';
        document.getElementById('speedtest-results').style.display = 'none';
    }
</script>
